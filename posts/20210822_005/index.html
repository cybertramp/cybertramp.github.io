<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="test">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Installation - ElasticSearch" />
<meta property="og:description" content="test" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/posts/20210822_005/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-08-22T00:00:00+00:00" />

<title>Installation - ElasticSearch | Cybertramp&#39;s blog</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e4c9d276e3009b37f61ee2c3d6947d72d526531ec31ccb110cad48d54e8b9bb5.css" integrity="sha256-5MnSduMAmzf2HuLD1pR9ctUmUx7DHMsRDK1I1U6Lm7U=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.b4eb4183b188c1dae825f332072a0260ba2a0ff2a4a6739894649724460d69a4.js" integrity="sha256-tOtBg7GIwdroJfMyByoCYLoqD/KkpnOYlGSXJEYNaaQ=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="/"><span>Cybertramp&#39;s blog</span>
  </a>
</h2>












  





  
<ul>
  
  <li>
    <a href="/profile/" >
        /etc/info
      </a>
  </li>
  
  <li>
    <a href="/links/" >
        /var/links
      </a>
  </li>
  
  <li>
    <a href="/posts/" >
        /var/posts
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Installation - ElasticSearch</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents"></nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="install-elasticsearch">
  install Elasticsearch
  <a class="anchor" href="#install-elasticsearch">#</a>
</h1>
<ul>
<li>주의</li>
</ul>
<blockquote>
<p>service로 동작하므로 wsl에서 테스트 불가</p>
</blockquote>
<ul>
<li>참고
<ul>
<li>
  <a href="https://www.digitalocean.com/community/tutorials/how-to-install-elasticsearch-logstash-and-kibana-elastic-stack-on-ubuntu-20-04">https://www.digitalocean.com/community/tutorials/how-to-install-elasticsearch-logstash-and-kibana-elastic-stack-on-ubuntu-20-04</a></li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -fsSL https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
$ echo <span style="color:#e6db74">&#34;deb https://artifacts.elastic.co/packages/7.x/apt stable main&#34;</span> | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list
$ sudo apt update
$ sudo apt install elasticsearch

$ sudo vi /etc/elasticsearch/elasticsearch.yml
</code></pre></div><p><code>/etc/elasticsearch/elasticsearch.yml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># ---------------------------------- Network -----------------------------------</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># Set the bind address to a specific IP (IPv4 or IPv6):</span>
<span style="color:#75715e">#</span>
<span style="color:#f92672">network.host</span>: <span style="color:#ae81ff">localhost</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo systemctl start elasticsearch
$ sudo systemctl enable elasticsearch
</code></pre></div><ul>
<li>
<p>Request Test</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -X GET <span style="color:#e6db74">&#34;localhost:9200&#34;</span>
</code></pre></div><pre><code> ![[Pasted image 20210527112333.png]]

</code></pre></li>
</ul>
<ol start="2">
<li>Install Kibana</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo apt install nginx
$ sudo apt install kibana
$ sudo systemctl enable kibana
$ sudo systemctl start kibana

$ echo <span style="color:#e6db74">&#34;kibanaadmin:`openssl passwd -apr1`&#34;</span> | sudo tee -a /etc/nginx/htpasswd.users
$ sudo vi /etc/nginx/sites-available/<span style="color:#f92672">{</span>SERVER_NAME<span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>
<p>localhost 이외에서 접근 허용</p>
<p><code>/etc/kibana/kibana.yml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#f92672">server.host</span>: <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>
<span style="color:#f92672">elasticsearch.hosts</span>: <span style="color:#ae81ff">\[&#34;http://localhost:9200&#34;\]</span>
</code></pre></div><pre><code>
</code></pre></li>
</ul>
<p><code>/etc/nginx/sites-available/{SERVER_NAME}</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nginx" data-lang="nginx"><span style="color:#66d9ef">server</span> {
    <span style="color:#f92672">listen</span> <span style="color:#ae81ff">5601</span>;

    <span style="color:#f92672">server_name</span> <span style="color:#e6db74">your_domain</span>;

    <span style="color:#f92672">auth_basic</span> <span style="color:#e6db74">&#34;Restricted</span> <span style="color:#e6db74">Access&#34;</span>;
    <span style="color:#f92672">auth_basic_user_file</span> <span style="color:#e6db74">/etc/nginx/htpasswd.users</span>;

    <span style="color:#f92672">location</span> <span style="color:#e6db74">/</span> {
        <span style="color:#f92672">proxy_pass</span> <span style="color:#e6db74">http://localhost:5601</span>;
        <span style="color:#f92672">proxy_http_version</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">.1</span>;
        <span style="color:#f92672">proxy_set_header</span> <span style="color:#e6db74">Upgrade</span> $http_upgrade;
        <span style="color:#f92672">proxy_set_header</span> <span style="color:#e6db74">Connection</span> <span style="color:#e6db74">&#39;upgrade&#39;</span>;
        <span style="color:#f92672">proxy_set_header</span> <span style="color:#e6db74">Host</span> $host;
        <span style="color:#f92672">proxy_cache_bypass</span> $http_upgrade;
    }
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo ln -s /etc/nginx/sites-available/<span style="color:#f92672">{</span>SERVER_NAME<span style="color:#f92672">}</span> /etc/nginx/sites-enabled/<span style="color:#f92672">{</span>SERVER_NAME<span style="color:#f92672">}</span>

$ sudo nginx -t
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo systemctl start nginx
$ sudo systemctl enable nginx
$ sudo systemctl reload nginx
</code></pre></div><ol start="3">
<li>Install Logstash</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo apt install logstash
$ sudo vi /etc/logstash/conf.d/logstash.conf
</code></pre></div><p><code>/etc/logstash/conf.d/logstash.conf</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">input {
  file { 
  	path =&gt; [
	  &#34;/FADU-FTP/TESTLOGS/*.*&#34;
	]
	start_position =&gt; &#34;beginning&#34; 
	sincedb_path =&gt; &#34;/dev/null&#34; 
  }
}

filter {
  grok {
    match =&gt; {&#34;path&#34; =&gt; &#34;%{GREEDYDATA:lotid}_ST470_%{GREEDYDATA:tester}-%{GREEDYDATA:dut}_%{GREEDYDATA:testtime}.txt&#34;}
  }
}

output { 
  elasticsearch {
    hosts =&gt; [&#34;localhost:9200&#34;]
  }
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># configure test</span>
$ sudo -u logstash /usr/share/logstash/bin/logstash --path.settings /etc/logstash -t
</code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents"></nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












